"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(BetaNgml:BetaNgmlUCL, as.numeric())
betas <- read_excel("PFNA_Unit_Conversion_v6.xlsx") %>%
as.data.frame() %>%
select(c("Study2", "Sample Size", "Population", "Confidence",
"BetaOrig", "BetaOrigLCL", "BetaOrigUCL", "BetaUnit",
"BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL",
"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(c("BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL"), as.numeric())
betas <- read_excel("PFNA_Unit_Conversion_v6.xlsx") %>%
as.data.frame() %>%
select(c("Study2", "Sample Size", "Population", "Confidence",
"BetaOrig", "BetaOrigLCL", "BetaOrigUCL", "BetaUnit",
"BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL",
"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(c("BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL"), as.numeric)
betas <- read_excel("PFNA_Unit_Conversion_v6.xlsx") %>%
as.data.frame() %>%
select(c("Study2", "Sample Size", "Population", "Confidence",
"BetaOrig", "BetaOrigLCL", "BetaOrigUCL", "BetaUnit",
"BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL",
"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(c("BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL"), as.double)
View(betas)
# pool studies that report boys and girls separately
betas <- betas %>%
pool_studies("Lind") %>%
pool_studies("Robledo") %>%
pool_studies("Wang")
# join sample timing data to betas
sampling <- read_excel("PFNA_Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
sampling2 <- sampling %>%
select(Study, Mean:Exact) %>%
pivot_longer(Mean:Exact, names_to = "Summary_Type") %>%
rename(GA = value) %>%
drop_na()
sampling <- left_join(sampling, sampling2, by = "Study")
betas <- betas  %>%     ## PFNA
select(!c(Author, Year)) %>%
left_join(sampling[, c("Study", "GA", "Bin", "Sampling_1", "Sampling_2", "Sampling_3")], by = "Study") %>%
mutate(Bin = factor(Bin),
Sampling_1 = factor(Sampling_1),
Sampling_2 = factor(Sampling_2),
Sampling_3 = factor(Sampling_3))
betas
View(betas)
# join sample timing data to betas
sampling <- read_excel("PFNA_Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
View(sampling)
# join sample timing data to betas
sampling <- read_excel("PFNA_Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
sampling2 <- sampling %>%
select(Study, Mean:Exact) %>%
pivot_longer(Mean:Exact, names_to = "Summary_Type") %>%
rename(GA = value) %>%
drop_na()
sampling <- left_join(sampling, sampling2, by = "Study")
betas <- betas  %>%     ## PFNA
select(!c(Author, Year)) %>%
left_join(sampling[, c("Study", "GA", "Bin", "Sampling_1", "Sampling_2", "Sampling_3")], by = "Study") %>%
mutate(Bin = factor(Bin),
Sampling_1 = factor(Sampling_1),
Sampling_2 = factor(Sampling_2),
Sampling_3 = factor(Sampling_3))
betas
View(betas)
# join sample timing data to betas
sampling <- read_excel("PFNA_Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
View(sampling)
# TODO re-code to take medians over means, etc. if more than one is reported
sampling2 <- sampling %>%
select(Study, Mean:Exact) %>%
pivot_longer(Mean:Exact, names_to = "Summary_Type") %>%
rename(GA = value) %>%
drop_na()
sampling <- left_join(sampling, sampling2, by = "Study")
betas <- betas  %>%     ## PFNA
select(!c(Author, Year)) %>%
left_join(sampling[, c("Study", "GA", "Bin", "Sampling_1", "Sampling_2", "Sampling_3")], by = "Study") %>%
mutate(Bin = factor(Bin),
Sampling_1 = factor(Sampling_1),
Sampling_2 = factor(Sampling_2),
Sampling_3 = factor(Sampling_3))
setwd("C:/Users/alarsen/OneDrive - Environmental Protection Agency (EPA)/Projects/IRIS/PFAS/pfas-birthweight-meta-analysis")
source("helper_functions.R")
betas <- read_excel("PFNA_Unit_Conversion_v6.xlsx") %>%
as.data.frame() %>%
select(c("Study2", "Sample Size", "Population", "Confidence",
"BetaOrig", "BetaOrigLCL", "BetaOrigUCL", "BetaUnit",
"BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL",
"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(c("BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL"), as.double)
# pool studies that report boys and girls separately
betas <- betas %>%
pool_studies("Lind") %>%
pool_studies("Robledo") %>%
pool_studies("Wang")
# join sample timing data to betas
sampling <- read_excel("PFNA_Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
# TODO re-code to take medians over means, etc. if more than one is reported
sampling2 <- sampling %>%
select(Study, Mean:Exact) %>%
pivot_longer(Mean:Exact, names_to = "Summary_Type") %>%
rename(GA = value) %>%
drop_na()
sampling <- left_join(sampling, sampling2, by = "Study")
betas <- betas  %>%     ## PFNA
select(!c(Author, Year)) %>%
left_join(sampling[, c("Study", "GA", "Bin", "Sampling_1", "Sampling_2", "Sampling_3")], by = "Study") %>%
mutate(Bin = factor(Bin),
Sampling_1 = factor(Sampling_1),
Sampling_2 = factor(Sampling_2),
Sampling_3 = factor(Sampling_3))
betas
View(betas)
#View(betas)
write.csv(betas, "betas_pfna.csv", row.names = F)
setwd("C:/Users/alarsen/OneDrive - Environmental Protection Agency (EPA)/Projects/IRIS/PFAS/pfas-birthweight-meta-analysis")
source("utility_functions.R")
pfas_type <- "PFNA" #or "PFHxS"
if (pfas_type == "PFNA") {
source("data_preprocess_pfna.R")
} else if (pfas_type == "PFHxS") {
source("data_preprocess_pfhxs.R")
}
setwd("C:/Users/alarsen/OneDrive - Environmental Protection Agency (EPA)/Projects/IRIS/PFAS/pfas-birthweight-meta-analysis")
source("utility_functions.R")
pfas_type <- "PFNA" #or "PFHxS"
if (pfas_type == "PFNA") {
source("data_preprocess_pfna.R")
} else if (pfas_type == "PFHxS") {
source("data_preprocess_pfhxs.R")
}
library(readxl)
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(metafor)
library(meta)
library(knitr)
library(kableExtra)
library(ggplot2)
library(RColorBrewer)
setwd("C:/Users/alarsen/OneDrive - Environmental Protection Agency (EPA)/Projects/IRIS/PFAS/pfas-birthweight-meta-analysis")
source("utility_functions.R")
betas <- read_excel("PFNA_Unit_Conversion_v6.xlsx") %>%
as.data.frame() %>%
select(c("Study2", "Sample Size", "Population", "Confidence",
"BetaOrig", "BetaOrigLCL", "BetaOrigUCL", "BetaUnit",
"BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL",
"BetaLnNgml", "BetaLnNgmlSE", "BetaLnNgmlLCL", "BetaLnNgmlUCL")) %>%
rename(Study = Study2) %>%
separate(col = Study, into = c("Author", "Year"), sep = ",", remove = F) %>%
mutate(across(c("Study", "Year"), str_replace, " Boy", "a")) %>%
mutate(across(c("Study", "Year"), str_replace, " Girl", "b")) %>%
mutate(Confidence = factor(Confidence, levels = c("High", "Medium", "Low")),
Population = factor(Population)) %>%
mutate_at(c("BetaNgml", "BetaNgmlSE", "BetaNgmlLCL", "BetaNgmlUCL"), as.double)
# pool studies that report boys and girls separately
betas <- betas %>%
pool_studies("Lind") %>%
pool_studies("Robledo") %>%
pool_studies("Wang")
# join sample timing data to betas
sampling <- read_excel("Sample_Timing.xlsx", sheet = "Sample_Timing") %>%
unite("Study", Author:Year, sep = ", ")
# TODO re-code to take medians over means, etc. if more than one is reported
sampling2 <- sampling %>%
select(Study, Mean:Exact) %>%
pivot_longer(Mean:Exact, names_to = "Summary_Type") %>%
rename(GA = value) %>%
drop_na()
sampling <- left_join(sampling, sampling2, by = "Study")
betas <- betas  %>%     ## PFNA
select(!c(Author, Year)) %>%
left_join(sampling[, c("Study", "GA", "Bin", "Sampling_1", "Sampling_2", "Sampling_3")], by = "Study") %>%
mutate(Bin = factor(Bin),
Sampling_1 = factor(Sampling_1),
Sampling_2 = factor(Sampling_2),
Sampling_3 = factor(Sampling_3))
#View(betas)
write.csv(betas, "betas_pfna.csv", row.names = F)
length(unique(betas$Stduy))
length(unique(betas$Study))
attach(betas)
length(Study)
knitr::opts_chunk$set(echo = params$print_code,
warning = FALSE,
tidy = TRUE) #tidy.opts = list(width.cutoff = 60), # if word_document
#rmarkdown::render(output_file = paste0("Meta_Analysis_", pfas, ".pdf"))
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(metafor)
library(meta)
library(knitr)
library(kableExtra)
library(ggplot2)
library(RColorBrewer)
library(formatR)
source("utility_functions.R")
if (pfas_type == "PFNA") {
betas <- read.csv("betas_pfna.csv")
} else if (pfas_type == "PFHxS") {
betas <- read.csv("betas_pfhxs.csv")
}
attach(betas)
rma_overall <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, slab = Study)
print_results("Overall", rma_overall, betas) %>% kable(format = 'pandoc')
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$StudySampleSize),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$StudySampleSize),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$SampleSize),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$StudySampleSize),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, plot_df$SampleSize),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$StudySampleSize),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$SampleSize),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$SampleSize),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$`Sample Size`),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$`Sample Size`),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
names(plot_df)
plot_df <- betas %>%
mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$Sample.Size),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$Sample.Size),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
p <- par(cex = .55, font=2)
text(c(-650, -500, -350), length(unique(Study))+2, c("Confidence", "Timing", "N"))
names(betas)
unique(Bin)
?fct_Recode
?fct_recode
plot_df <- betas %>%
#mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post")) %>%
mutate(SampleTiming = fct_recode(SampleTiming, `1st` = "T1", `1st-2nd` = "T1-T2", `2nd` = "T2",
`2nd-3rd` = "T2-T3", `3rd` = "T3", `Birth` = "B", `Post-Birth` = "PB"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
plot_df <- betas %>%
#mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post")) %>%
mutate(SampleTiming = fct_recode(Bin, `1st` = "T1", `1st-2nd` = "T1-T2", `2nd` = "T2",
`2nd-3rd` = "T2-T3", `3rd` = "T3", `Birth` = "B", `Post-Birth` = "PB"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$Sample.Size),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$Sample.Size),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
p <- par(cex = .55, font=2)
text(c(-650, -500, -350), length(unique(Study))+2, c("Confidence", "Timing", "N"))
plot_df <- betas %>%
#mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post")) %>%
mutate(SampleTiming = fct_recode(Bin, `1st` = "T1", `1st-2nd` = "T1-T2", `2nd` = "T2",
`2nd-3rd` = "T2-T3", `3rd` = "T3", `Birth` = "B", `Post-Birth` = "PB",
`Pre-Conception` = "PC"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$Sample.Size),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$Sample.Size),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
p <- par(cex = .55, font=2)
text(c(-650, -500, -350), length(unique(Study))+2, c("Confidence", "Timing", "N"))
plot_df <- betas %>%
#mutate(SampleTiming = fct_recode(Sampling_3, Early = "early", Late = "late", Post = "post")) %>%
mutate(SampleTiming = fct_recode(Bin, `1st` = "T1", `1st-2nd` = "T1-T2", `2nd` = "T2",
`2nd-3rd` = "T2-T3", `3rd` = "T3", `Birth` = "B", `Post-Birth` = "PB",
`Pre-Conception` = "PC"),
Confidence = factor(Confidence, levels = c("High", "Medium", "Low")))
forest(rma_overall,
cex = .55,
level = 95,
digits = 1L,
xlim = c(-1100, 500),
alim = c(-200, 200),
order = order(plot_df$Confidence, plot_df$SampleTiming, -plot_df$Sample.Size),
header = "Study",
ilab = cbind(as.character(plot_df$Confidence),
as.character(plot_df$SampleTiming),
plot_df$Sample.Size),
ilab.xpos = c(-650, -500, -350),
slab = plot_df$Study,
xlab = NULL,
mlab = modify_label(rma_overall, "All Studies, RE Model"))
p <- par(cex = .55, font=2)
text(c(-650, -500, -350), length(Study)+2, c("Confidence", "Timing", "N"))
loo <- leave1out(rma_overall, digits = 2) %>%
as.data.frame() %>%
mutate_at(c(1:3, 5:11), ~round(., 2)) %>%
mutate_at(c(4), ~round(., 5)) %>%
add_column(Study, .before = "estimate")
ind <- which(loo$I2 == min(loo$I2))
kable(loo, format = 'pandoc')
# funnel plot code adapted from Kristen Rappazzo's "OZONE and PRETERM BIRTH META-ANALYSIS"
regtest_out <- regtest(rma_overall, model = "rma", predictor = "sei")
regtest_p <- round(regtest_out$pval, 4)
funnel(rma_overall, xlab = sprintf("Effect Estimate of ln-%s on Birth-Weight", params$pfas_type)) # label = 3)
knitr::opts_chunk$set(echo = params$print_code,
warning = FALSE,
tidy = TRUE) #tidy.opts = list(width.cutoff = 60), # if word_document
#rmarkdown::render(output_file = paste0("Meta_Analysis_", pfas, ".pdf"))
library(readxl)
library(tidyr)
library(tidyverse)
library(dplyr)
library(metafor)
library(meta)
library(knitr)
library(kableExtra)
library(ggplot2)
library(RColorBrewer)
library(formatR)
source("utility_functions.R")
pfas_type = "PFNA"
if (pfas_type == "PFNA") {
betas <- read.csv("betas_pfna.csv")
} else if (pfas_type == "PFHxS") {
betas <- read.csv("betas_pfhxs.csv")
}
attach(betas)
names(betas)
Sampling_1
rma_early <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ Sampling_3, data = betas, subset = Sampling_3 == "early")
rma_late <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ Sampling_3, data = betas, subset = Sampling_3 == "late")
rma_post <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ Sampling_3, data = betas, subset = Sampling_3 == "post")
#
# m3_third1_ln <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ SampleTiming3, data = df3, subset = SampleTiming3 == "T1_T1.5")
# m3_third2_ln <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ SampleTiming3, data = df3, subset = SampleTiming3 == "T2_3")
# m3_third3_ln <- rma(yi = BetaLnNgml, sei = BetaLnNgmlSE, mods = ~ SampleTiming3, data = df3, subset = SampleTiming3 == "B_PB")
rbind(
print_out("Early", rma_early, betas %>% filter(Sampling_3 == "early")),
print_out("Late", rma_late, betas %>% filter(Sampling_3 == "late")),
print_out("Post", rma_post, betas %>% filter(Sampling_3 == "post"))) # %>% kable(format = "pandoc")
source("utility_functions.R")
rbind(
print_out("Early", rma_early, betas %>% filter(Sampling_3 == "early")),
print_out("Late", rma_late, betas %>% filter(Sampling_3 == "late")),
print_out("Post", rma_post, betas %>% filter(Sampling_3 == "post"))) # %>% kable(format = "pandoc")
rbind(
print_results("Early", rma_early, betas %>% filter(Sampling_3 == "early")),
print_results("Late", rma_late, betas %>% filter(Sampling_3 == "late")),
print_results("Post", rma_post, betas %>% filter(Sampling_3 == "post"))) # %>% kable(format = "pandoc")
# rbind(
#   print_out("T1-T1.5", m3_third1_ln, df3 %>% filter(SampleTiming3 == "T1_T1.5")),
#   print_out("T2-3", m3_third2_ln, df3 %>% filter(SampleTiming3 == "T2_3")),
#   print_out("B-PB", m3_third3_ln, df3 %>% filter(SampleTiming3 == "B_PB"))) %>% kable(format = "pandoc")
sampling_results <- data.frame(estimate = c(coef(rma_early), coef(rma_late), coef(rma_post)),
SE = c(rma_early$se, rma_late$se, rma_post$se),
strata = c("T1-T.5", "T2-3", "B-PB"),
tau2 = round(c(rma_early$tau2, rma_late$tau2, rma_post$tau2), 3))
# allmods <- data.frame(estimate = c(coef(m3_third1_ln), coef(m3_third2_ln), coef(m3_third3_ln)),
#                       SE = c(m3_third1_ln$se, m3_third2_ln$se, m3_third3_ln$se),
#                       strata = c("T1-T.5", "T2-3", "B-PB"),
#                       tau2 = round(c(m3_third1_ln$tau2, m3_third2_ln$tau2, m3_third3_ln$tau2), 3))
out <- rma(estimate, sei = SE, mods = ~ strata, method = "FE", data = sampling_results)
p <- round(out$QMp, 4)
p
sampling_results <- data.frame(estimate = c(coef(rma_early), coef(rma_late), coef(rma_post)),
SE = c(rma_early$se, rma_late$se, rma_post$se),
strata = c("T1-T.5", "T2-3", "B-PB"),
tau2 = round(c(rma_early$tau2, rma_late$tau2, rma_post$tau2), 3))
rma_sampling <- rma(estimate, sei = SE, mods = ~ strata, method = "FE", data = sampling_results)
p <- round(rma_sampling$QMp, 4)
p
